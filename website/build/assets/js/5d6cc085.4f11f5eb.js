"use strict";(globalThis.webpackChunkrituals_app_docs=globalThis.webpackChunkrituals_app_docs||[]).push([[1113],{8128:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"backend/setup","title":"Setup & Installation","description":"This guide covers the setup process for the Node.js backend server. You can run the backend either entirely via Docker or manually for development.","source":"@site/docs/backend/setup.md","sourceDirName":"backend","slug":"/backend/setup","permalink":"/docs/backend/setup","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Introduction","permalink":"/docs/intro"},"next":{"title":"Architecture","permalink":"/docs/backend/architecture"}}');var s=i(4848),t=i(8453);const l={sidebar_position:1},a="Setup & Installation",d={},c=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Option 1: Quick Start (Docker) \ud83d\udc33",id:"option-1-quick-start-docker-",level:2},{value:"Option 2: Manual Setup (Local Development) \ud83d\udee0\ufe0f",id:"option-2-manual-setup-local-development-\ufe0f",level:2},{value:"1. Install Dependencies",id:"1-install-dependencies",level:3},{value:"2. Environment Configuration",id:"2-environment-configuration",level:3},{value:"3. Firebase Setup",id:"3-firebase-setup",level:3},{value:"4. Start the Database",id:"4-start-the-database",level:3},{value:"5. Initialize Data",id:"5-initialize-data",level:3},{value:"6. Start the Server",id:"6-start-the-server",level:3},{value:"Available Scripts",id:"available-scripts",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Database Connection Refused",id:"database-connection-refused",level:3},{value:"Firebase Errors",id:"firebase-errors",level:3}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"setup--installation",children:"Setup & Installation"})}),"\n",(0,s.jsx)(n.p,{children:"This guide covers the setup process for the Node.js backend server. You can run the backend either entirely via Docker or manually for development."}),"\n",(0,s.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsx)(n.p,{children:"Ensure you have the following installed:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Node.js"})," (v18 or higher)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Docker Desktop"})," (Required for PostgreSQL database)"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Git"})}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"option-1-quick-start-docker-",children:"Option 1: Quick Start (Docker) \ud83d\udc33"}),"\n",(0,s.jsx)(n.p,{children:"The easiest way to get the entire stack (API + Database) running."}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Navigate to the backend directory:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd backend\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Run Docker Compose:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker-compose up --build\n"})}),"\n",(0,s.jsx)(n.p,{children:"This will:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Start a PostgreSQL container on port ",(0,s.jsx)(n.code,{children:"5432"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Start the Backend API on port ",(0,s.jsx)(n.code,{children:"3000"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Automatically apply environment variables defined in ",(0,s.jsx)(n.code,{children:"docker-compose.yml"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Verify:"}),"\r\nOpen ",(0,s.jsx)(n.a,{href:"http://localhost:3000/api-docs",children:"http://localhost:3000/api-docs"})," to see the Swagger documentation."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"option-2-manual-setup-local-development-\ufe0f",children:"Option 2: Manual Setup (Local Development) \ud83d\udee0\ufe0f"}),"\n",(0,s.jsx)(n.p,{children:"Recommended if you want to run the Node.js server locally for debugging while keeping the database in Docker."}),"\n",(0,s.jsx)(n.h3,{id:"1-install-dependencies",children:"1. Install Dependencies"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd backend\r\nnpm install\n"})}),"\n",(0,s.jsx)(n.h3,{id:"2-environment-configuration",children:"2. Environment Configuration"}),"\n",(0,s.jsxs)(n.p,{children:["Create a ",(0,s.jsx)(n.code,{children:".env"})," file in the ",(0,s.jsx)(n.code,{children:"backend"})," root directory."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-env",metastring:'title="backend/.env"',children:"# Server Configuration\r\nPORT=3001\r\nNODE_ENV=development\r\n\r\n# Database Configuration\r\nDB_HOST=localhost\r\nDB_USER=postgres\r\nDB_PASSWORD=postgres\r\nDB_NAME=rituals_db\r\nDB_PORT=5432\r\n\r\n# Security\r\nJWT_SECRET=your_super_secret_key_change_this\r\n\r\n# Firebase (Required for Notifications)\r\n# Path to your service account file relative to root\r\nGOOGLE_APPLICATION_CREDENTIALS=./firebase-service-account.json\r\n\r\n# Email Service (Optional)\r\nEMAIL_USER=your_email@gmail.com\r\nEMAIL_PASS=your_app_password\n"})}),"\n",(0,s.jsx)(n.h3,{id:"3-firebase-setup",children:"3. Firebase Setup"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Go to the Firebase Console."}),"\n",(0,s.jsx)(n.li,{children:"Generate a new private key (Service Account)."}),"\n",(0,s.jsxs)(n.li,{children:["Save the file as ",(0,s.jsx)(n.code,{children:"firebase-service-account.json"})," in the ",(0,s.jsx)(n.code,{children:"backend/"})," folder."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"4-start-the-database",children:"4. Start the Database"}),"\n",(0,s.jsx)(n.p,{children:"Run only the database container:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker-compose up -d db\n"})}),"\n",(0,s.jsx)(n.h3,{id:"5-initialize-data",children:"5. Initialize Data"}),"\n",(0,s.jsx)(n.p,{children:"Run the gamification initialization script to seed badges and levels:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm run init-gamification\n"})}),"\n",(0,s.jsx)(n.h3,{id:"6-start-the-server",children:"6. Start the Server"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Development mode (with hot-reload)\r\nnpm run dev\r\n\r\n# Production mode\r\nnpm start\n"})}),"\n",(0,s.jsxs)(n.p,{children:["The server will start on ",(0,s.jsx)(n.code,{children:"http://localhost:3001"}),"."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"available-scripts",children:"Available Scripts"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"Command"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"npm run dev"})}),(0,s.jsxs)(n.td,{style:{textAlign:"left"},children:["Starts the server with ",(0,s.jsx)(n.code,{children:"nodemon"})," for hot-reloading."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"npm start"})}),(0,s.jsxs)(n.td,{style:{textAlign:"left"},children:["Starts the server using ",(0,s.jsx)(n.code,{children:"ts-node"}),"."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"npm run init-gamification"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Seeds the database with initial badges and gamification rules."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"npm run migrate-partnerships"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Migration script for updating partnership data structure."})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,s.jsx)(n.h3,{id:"database-connection-refused",children:"Database Connection Refused"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Ensure Docker Desktop is running."}),"\n",(0,s.jsxs)(n.li,{children:["Check if port ",(0,s.jsx)(n.code,{children:"5432"})," is already in use."]}),"\n",(0,s.jsxs)(n.li,{children:["If running locally, ensure ",(0,s.jsx)(n.code,{children:"DB_HOST=localhost"}),". If running inside Docker, ",(0,s.jsx)(n.code,{children:"DB_HOST=db"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"firebase-errors",children:"Firebase Errors"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Ensure ",(0,s.jsx)(n.code,{children:"firebase-service-account.json"})," exists and is valid."]}),"\n",(0,s.jsxs)(n.li,{children:["Check ",(0,s.jsx)(n.code,{children:"GOOGLE_APPLICATION_CREDENTIALS"})," path in ",(0,s.jsx)(n.code,{children:".env"}),"."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}}}]);